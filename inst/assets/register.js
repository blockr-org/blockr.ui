(()=>{"use strict";var t;Sortable,function(t){t[t.noStack=1]="noStack",t[t.noBlockIndex=2]="noBlockIndex",t[t.stackAlreadyHasDataBlock=3]="stackAlreadyHasDataBlock",t[t.stackAlreadyHasPlotBlock=4]="stackAlreadyHasPlotBlock"}(t||(t={}));var e,a=new Map;a.set(t.noStack,"must drag blocks within a stack"),a.set(t.noBlockIndex,"could not find block index"),a.set(t.stackAlreadyHasDataBlock,"this stack already includes a data block"),a.set(t.stackAlreadyHasPlotBlock,"this stack already includes a plot block"),function(t){t[t.deferred=1]="deferred",t[t.throttled=2]="throttled",t[t.immediate=3]="immediate"}(e||(e={}));var o=new Map;function c(t){var o={ns:t.ns,id:"error",message:{type:t.type,message:a.get(t.type)||"unknown error"},priority:e.immediate};console.error("".concat(o.message.message)),l(o)}function l(t){var e=t.id;t.ns&&(e="".concat(t.ns,"-").concat(e));var a=o.get(t.priority)||"deferred";Shiny.setInputValue(e,t.message,{priority:a})}o.set(e.deferred,"deferred"),o.set(e.throttled,"throttle"),o.set(e.immediate,"event"),$((function(){Shiny.addCustomMessageHandler("block-list-init",(function(t){for(var e=document.querySelectorAll("#".concat(t.id," .block-list-wrapper")),a=0;a<e.length;++a)new Sortable(e[a],n(t.ns))}))}));var n=function(a){return{draggable:".add-block",onEnd:function(o){var n=o.originalEvent.srcElement,s=$(n).closest(".stack"),r={id:"error",ns:a,type:t.noStack};if(s.length){var d=$(o.item).data("type"),i=[];$(n).closest(".stack").find("[data-block-type]").each((function(t,e){var a=$(e).data("block-type").split(",");i.push.apply(i,a)}));var k,y=s.attr("id").split("-")[1],p=$(n).closest(".block").data("value");return s.find(".block").each((function(t,e){$(e).data("value")==p&&(k=t+1)})),k?i.includes("dataset_block")&&"dataset_block"==d?(r.type=t.stackAlreadyHasDataBlock,void c(r)):i.includes("plot_block")&&"plot_block"==d?(r.type=t.stackAlreadyHasPlotBlock,void c(r)):void l({id:"block",ns:a,message:{stackId:y,blockId:p,blockIndex:k,type:d},priority:e.immediate}):(r.type=t.noBlockIndex,void c(r))}c(r)}}}})();