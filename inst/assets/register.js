(()=>{"use strict";var t;Sortable,function(t){t[t.noStack=1]="noStack",t[t.noBlockIndex=2]="noBlockIndex",t[t.stackAlreadyHasDataBlock=3]="stackAlreadyHasDataBlock",t[t.stackAlreadyHasPlotBlock=4]="stackAlreadyHasPlotBlock"}(t||(t={}));var e=new Map;e.set(t.noStack,"must drag blocks within a stack"),e.set(t.noBlockIndex,"could not find block index"),e.set(t.stackAlreadyHasDataBlock,"this stack already includes a data block"),e.set(t.stackAlreadyHasPlotBlock,"this stack already includes a plot block");var a,o=new Map;o.set(t.noStack,"no-stack"),o.set(t.noBlockIndex,"no-block-index"),o.set(t.stackAlreadyHasDataBlock,"stack-already-has-data-block"),o.set(t.stackAlreadyHasPlotBlock,"stack-already-has-plot-block"),function(t){t[t.deferred=1]="deferred",t[t.throttled=2]="throttled",t[t.immediate=3]="immediate"}(a||(a={}));var c=new Map;function l(t){var c={ns:t.ns,id:"error",message:{type:o.get(t.type)||"unknown error",message:e.get(t.type)||"unknown error"},priority:a.immediate};console.error("".concat(c.message.message)),s(c)}function s(t){var e=t.id;t.ns&&(e="".concat(t.ns,"-").concat(e));var a=c.get(t.priority)||"deferred";Shiny.setInputValue(e,t.message,{priority:a})}c.set(a.deferred,"deferred"),c.set(a.throttled,"throttle"),c.set(a.immediate,"event"),$((function(){Shiny.addCustomMessageHandler("block-list-init",(function(t){for(var e=document.querySelectorAll("#".concat(t.id," .block-list-wrapper")),a=0;a<e.length;++a)new Sortable(e[a],n(t.ns))}))}));var n=function(e){return{draggable:".add-block",onEnd:function(o){var c=o.originalEvent.srcElement,n=$(c).closest(".stack"),r={id:"error",ns:e,type:t.noStack};if(n.length){var d=$(o.item).data("type"),i=[];$(c).closest(".stack").find("[data-block-type]").each((function(t,e){var a=$(e).data("block-type").split(",");i.push.apply(i,a)}));var k,y=n.attr("id").split("-")[1],p=$(c).closest(".block").data("value");return n.find(".block").each((function(t,e){$(e).data("value")==p&&(k=t+1)})),k?i.includes("dataset_block")&&"dataset_block"==d?(r.type=t.stackAlreadyHasDataBlock,void l(r)):i.includes("plot_block")&&"plot_block"==d?(r.type=t.stackAlreadyHasPlotBlock,void l(r)):void s({id:"block",ns:e,message:{stackId:y,blockId:p,blockIndex:k,type:d},priority:a.immediate}):(r.type=t.noBlockIndex,void l(r))}l(r)}}}})();